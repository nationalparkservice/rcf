---
title: "Untitled"
author: "Janelle Christensen"
date: "8/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r, fig.width=15, fig.height=9}

library(rcf)
my_directory <- here::here()
corner_year <- read_csv("C:/Users/jnchr/Documents/test/BAND_year_summary_c.csv")
thresholds <- read_csv("C:/Users/jnchr/Documents/test/site_testing/ANTI/ANTI_thresholds.csv")

corner_year$time <- factor(corner_year$time, levels = c("Historical", "Future"))

ggplot(data = corner_year, aes(x = time, y = precip_yearly)) +
  geom_boxplot(aes(color = time,
                   fill = time),
               alpha = 0.2) +
  geom_jitter(aes(color = time),
              size = 2.5,
              alpha =.6) +
  facet_wrap(~corner) +
  scale_color_manual(values = c("#8386CC", "#12045C")) +
  scale_fill_manual(values = c("#8386CC", "#12045C")) +
  labs(y = "Yearly Precipitation (in)",
       title = "Yearly precipitation for individual GCMs representative of 4 climate futures") +
  theme_minimal() +
  theme(text = element_text(size = 20),
        legend.title = element_blank(),
        axis.title.x = element_blank())
```
This graph could be made for any of the variables in the output from the `cf_quadrant()` function, so let's look at a few more. 

How do number of days that exceed the historical 99th percentile of heat compare in the past and future?

```{r, fig.width=15, fig.height=9}
ggplot(data = corner_year, aes(x = time, y = temp_over_99_pctl)) +
  geom_boxplot(aes(color = time,
                   fill = time),
               alpha = 0.2) +
  geom_jitter(aes(color = time),
              size = 2.5,
              alpha =.6) +
  facet_wrap(~corner) +
  scale_color_manual(values = c("darksalmon", "#E10720")) +
  scale_fill_manual(values = c("darksalmon", "#E10720")) +
  labs(y = "Number of days per year",
       title = "Days where temperature exceeds the 99th percentile for\n individual GCMs representative of 4 climate futures") +
  theme_minimal() +
  theme(text = element_text(size = 20),
        legend.title = element_blank(),
        axis.title.x = element_blank(),
        plot.title = element_text(hjust = 0.5))
```
What about the growing season length? How does that compare in the past and in the future

```{r, fig.width=15, fig.height=9, warning=FALSE}
ggplot(data = corner_year, aes(x = time, y = grow_length)) +
  geom_boxplot(aes(color = time,
                   fill = time),
               alpha = 0.2) +
  geom_jitter(aes(color = time),
              size = 2.5,
              alpha =.6) +
  facet_wrap(~corner) +
  scale_color_manual(values = c("darkseagreen3", "darkseagreen4")) +
  scale_fill_manual(values = c("darkseagreen3", "darkseagreen4")) +
  labs(y = "Length of growing season",
       title = "Growing season length for individual GCMs representative of 4 climate futures") +
  theme_minimal() +
  theme(text = element_text(size = 20),
        legend.title = element_blank(),
        axis.title.x = element_blank(),
        plot.title = element_text(hjust = 0.5))
```

What if we want to compare by season or month? We can use the `cf_quadrant()` function again, this time summarizing by either month or season.


```{r}
corner_year_future <- corner_year %>%
filter(time %in% c("Future"))

ggplot(data = corner_year_future, aes(x = time, y = grow_length)) +
  geom_boxplot(aes(color = corner,
                   fill = corner),
               alpha = 0.2) +
  geom_jitter(aes(color = corner),
              size = 2.5,
              alpha =.6) +
  facet_wrap(~corner) +
  scale_color_manual(values = c("#8FD834", "#72CC50", "#019875", "#00AEAD")) +
  scale_fill_manual(values = c("#8FD834", "#72CC50", "#019875", "#00AEAD")) +
  labs(y = "Length of growing season",
       title = "Growing season length for individual GCMs representative of 4 climate futures") +
  theme_minimal() +
  theme(text = element_text(size = 20),
        legend.title = element_blank(),
        axis.title.x = element_blank(),
        plot.title = element_text(hjust = 0.5))
```

